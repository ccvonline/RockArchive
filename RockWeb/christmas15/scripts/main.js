"use strict";function findNearestCampus(e){function t(e,t){if(t===google.maps.DistanceMatrixStatus.OK){for(var a,i,s=Number.POSITIVE_INFINITY,o=e.rows[0].elements,l=0;l<o.length;l++)i=o[l].duration.value,s>i&&(s=i,a=l);n.removeClass("is-loading"),setActiveCampus(templateData.campuses[a].id)}}function a(){for(var e=[],t=0;t<templateData.campuses.length;t++){var a=templateData.campuses[t].geo,n=new google.maps.LatLng(a.lat,a.lng);e.push(n)}return e}var n=$(e),i=new google.maps.DistanceMatrixService;navigator.geolocation&&(n.addClass("is-loading"),navigator.geolocation.getCurrentPosition(function(e){var n=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);i.getDistanceMatrix({origins:[n],destinations:a(),travelMode:google.maps.TravelMode.DRIVING},t)}))}var md=new MobileDetect(window.navigator.userAgent);Handlebars.registerHelper("isPhone",function(e){return md.phone()?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("rowSpan",function(e){return e.length+1}),Handlebars.registerHelper("mapUrl",function(){var e=encodeURIComponent(this.street+" "+this.city+", "+this.state+" "+this.zip);return"http://maps.apple.com/maps?daddr="+e}),Handlebars.registerHelper("removeAst",function(e){return e.replace(" *","")}),Handlebars.registerHelper("emailSingle",function(e,t,a){return"mailto:?subject="+encodeURIComponent(text.emailSubject)+"&body="+encodeURIComponent(text.emailSingleP1)+encodeURIComponent(e)+encodeURIComponent(text.emailSingleP2)+encodeURIComponent(t)+encodeURIComponent(text.emailSingleP3)+encodeURIComponent(a)+encodeURIComponent(text.emailSingleP4)}),Handlebars.registerHelper("emailAll",function(){var e="";if(e+=text.emailAllP1,e+=this.name,e+=text.emailAllP2,this.times.tue){e+="\n"+this.tueLabel+"\n";for(var t=0;t<this.times.tue.length;t++){var a=this.times.tue[t];e+="- "+a+"\n"}}if(this.times.wed){e+="\n"+this.wedLabel+"\n";for(var t=0;t<this.times.wed.length;t++){var a=this.times.wed[t];e+="- "+a+"\n"}}if(this.times.thu){e+="\n"+this.thuLabel+"\n";for(var t=0;t<this.times.thu.length;t++){var a=this.times.thu[t];e+="- "+a+"\n"}}this.hasSpecialService&&(e+=text.emailAllP3);var n="mailto:?subject="+encodeURIComponent(text.emailSubject)+"&body="+encodeURIComponent(e);return n}),Handlebars.registerHelper("textSingle",function(e,t,a){var n=text.textSingleP1+e+text.textSingleP2+t+text.textSingleP3+a+text.textSingleP4;return"sms:&body="+encodeURIComponent(n)}),Handlebars.registerHelper("textAll",function(){var e=text.textAllP1+this.name+text.textAllP2;return"sms:&body="+encodeURIComponent(e)});var source=$("#campuses-template").html(),template=Handlebars.compile(source);$("#campuses-container").append(template(templateData)),$(document).ready(function(){$("body").on("click",".campus .title",function(){var e=$(this);e.siblings(".collapse").collapse("toggle"),e.parents(".campus").toggleClass("open")}),$("#inviteModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=t.data("invite-method"),n="",i=t.data("campus-id"),s=templateData.campuses.filter(function(e){return e.id===i})[0];switch(s.tueLabel=templateData.tueLabel,s.wedLabel=templateData.wedLabel,s.thuLabel=templateData.thuLabel,a){case"email":n="Send an email invite";break;case"text":n="Send a text message invite";break;case"facebook":n="Share on Facebook"}var o=$("#"+a+"-invite-template").html(),l=Handlebars.compile(o),r=$(this);r.find(".modal-title").text(n),r.find(".modal-body").html(l(s))})});var setActiveCampus=function(e){var t=$(".campus.active");t.length&&t.removeClass("active open").find(".collapse").removeClass("in"),$(".campus[data-campus-id="+e+"]").addClass("active open").insertBefore(".campus:first").find(".collapse").addClass("in"),Cookies.set("christmas_campus",e)},cookie=Cookies.get("christmas_campus");cookie&&setActiveCampus(cookie),navigator.geolocation&&$(".js-find-nearest-container").html('<button type="button" class="btn btn-default find-nearest" onClick="findNearestCampus(this)"><i class="loading-icon"></i> Find Nearest Campus</button>');