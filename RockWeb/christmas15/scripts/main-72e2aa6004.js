"use strict";function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function determineInitialCampus(){var e;getParameterByName("SetContext")?e=getParameterByName("SetContext").replace("Rock.Model.Campus|",""):Cookies.get("christmas_campus")?e=Cookies.get("christmas_campus"):$.get("/api/Utility/GetCampusContext",function(e){setActiveCampus(e)}),e&&setActiveCampus(e)}function findNearestCampus(e){function t(e,t){if(t===google.maps.DistanceMatrixStatus.OK){for(var a,i,o=Number.POSITIVE_INFINITY,s=e.rows[0].elements,r=0;r<s.length;r++)i=s[r].duration.value,o>i&&(o=i,a=r);n.removeClass("is-loading"),setActiveCampus(templateData.campuses[a].id)}}function a(){for(var e=[],t=0;t<templateData.campuses.length;t++){var a=templateData.campuses[t].geo,n=new google.maps.LatLng(a.lat,a.lng);e.push(n)}return e}var n=$(e),i=new google.maps.DistanceMatrixService;navigator.geolocation&&(n.addClass("is-loading"),navigator.geolocation.getCurrentPosition(function(e){var n=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);i.getDistanceMatrix({origins:[n],destinations:a(),travelMode:google.maps.TravelMode.DRIVING},t)})),ga("send",{hitType:"event",eventCategory:"Christmas Invite Page",eventAction:"Find Nearest Campus"})}var text={emailSubject:"Join us for Christmas service at CCV",emailSingleP1:"We're going to Christmas service at CCV. Would you like to join us? We'll be attending the ",emailSingleP2:" service on ",emailSingleP3:" on the ",emailSingleP4:" campus. Letâ€™s go together!\n\nhttp://ccvchristmas.com",emailAllP1:"We're going to Christmas service at CCV on the ",emailAllP2:" Campus. Would you like to join us? Check out the service times at http://ccvchristmas.com and let's plan to go together!\n",emailAllP3:"\n* Special needs services available",emailAllP3b:"\n** Sign language translation and special needs services available",textSingleP1:"Come to Christmas at CCV with us! We'll be going to the ",textSingleP2:" service on ",textSingleP3:" at the ",textSingleP4:" campus. You should join us! http://ccvchristmas.com",textAllP1:"We're going to Christmas service at CCV on the ",textAllP2:" campus. Would you like to join us? Check out the service times at http://ccvchristmas.com and let's plan to go together!"},templateData={campuses:[{id:1,shortcode:"peo",name:"Peoria",geo:{lat:33.7110943,lng:-112.2088517},phone:"(623) 376-2444",street:"7007 W Happy Valley Rd",city:"Peoria",state:"AZ",zip:"85383-3223",times:{tue:["6:00 pm","7:30 pm"],wed:["4:30 pm","6:00 pm **","7:30 pm"],thu:["1:30 pm","3:00 pm","4:30 pm","6:00 pm **","7:30 pm"]},hasBothSpecialService:!0},{id:5,shortcode:"sur",name:"Surprise",geo:{lat:33.5875394,lng:-112.3785948},phone:"(623) 875-9000",street:"14787 W Cholla St",city:"Surprise",state:"AZ",zip:"85379-4418",times:{tue:["6:00 pm"],wed:["4:30 pm","6:00 pm **","7:30 pm"],thu:["1:30 pm","3:00 pm","4:30 pm","6:00 pm **","7:30 pm"]},hasBothSpecialService:!0},{id:6,shortcode:"sco",name:"Scottsdale",geo:{lat:33.65789,lng:-111.88851},phone:"(480) 502-9800",street:"19030 N Pima Rd",city:"Scottsdale",state:"AZ",zip:"85255-5392",times:{wed:["6:00 pm *","7:30 pm"],thu:["3:00 pm","4:30 pm","6:00 pm *"]}},{id:7,shortcode:"eav",name:"East Valley",geo:{lat:33.3912,lng:-111.61549},phone:"(480) 218-1456",street:"1330 S Crismon Rd",city:"Mesa",state:"AZ",zip:"85209-3767",times:{wed:["6:00 pm *","7:30 pm"],thu:["3:00 pm","4:30 pm","6:00 pm *"]}},{id:8,shortcode:"ath",name:"Anthem",geo:{lat:33.84683,lng:-112.13706},phone:"(623) 561-3700",street:"39905 N Gavilan Peak Pkwy",city:"Anthem",state:"AZ",zip:"85086-2521",times:{tue:["6:00 pm"],wed:["4:30 pm","6:00 pm *","7:30 pm"],thu:["1:30 pm","3:00 pm","4:30 pm","6:00 pm *"]}},{id:9,shortcode:"avd",name:"Avondale",geo:{lat:33.4636054,lng:-112.301477},phone:"(623) 561-3600",street:"1565 N 113th Ave",city:"Avondale",state:"AZ",zip:"85392-3935",times:{tue:["6:00 pm"],wed:["4:30 pm","6:00 pm *","7:30 pm"],thu:["3:00 pm","4:30 pm","6:00 pm *"]}}],tueLabel:"Tuesday 12/22",wedLabel:"Wednesday 12/23",thuLabel:"Thursday 12/24"},md=new MobileDetect(window.navigator.userAgent);Handlebars.registerHelper("isPhone",function(e){return md.phone()?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("rowSpan",function(e){return e.length+1}),Handlebars.registerHelper("mapUrl",function(){var e=encodeURIComponent(this.street+" "+this.city+", "+this.state+" "+this.zip);return"http://maps.apple.com/maps?daddr="+e}),Handlebars.registerHelper("removeAst",function(e){return e.replace(" **","").replace(" *","")}),Handlebars.registerHelper("emailSingle",function(e,t,a){return"mailto:?subject="+encodeURIComponent(text.emailSubject)+"&body="+encodeURIComponent(text.emailSingleP1)+encodeURIComponent(e)+encodeURIComponent(text.emailSingleP2)+encodeURIComponent(t)+encodeURIComponent(text.emailSingleP3)+encodeURIComponent(a)+encodeURIComponent(text.emailSingleP4)}),Handlebars.registerHelper("emailAll",function(){var e="";if(e+=text.emailAllP1,e+=this.name,e+=text.emailAllP2,this.times.tue){e+="\n"+this.tueLabel+"\n";for(var t=0;t<this.times.tue.length;t++){var a=this.times.tue[t];e+="- "+a+"\n"}}if(this.times.wed){e+="\n"+this.wedLabel+"\n";for(var t=0;t<this.times.wed.length;t++){var a=this.times.wed[t];e+="- "+a+"\n"}}if(this.times.thu){e+="\n"+this.thuLabel+"\n";for(var t=0;t<this.times.thu.length;t++){var a=this.times.thu[t];e+="- "+a+"\n"}}e+=this.hasBothSpecialService?text.emailAllP3b:text.emailAllP3;var n="mailto:?subject="+encodeURIComponent(text.emailSubject)+"&body="+encodeURIComponent(e);return n}),Handlebars.registerHelper("textSingle",function(e,t,a){var n=text.textSingleP1+e+text.textSingleP2+t+text.textSingleP3+a+text.textSingleP4;return"sms:&body="+encodeURIComponent(n)}),Handlebars.registerHelper("textAll",function(){var e=text.textAllP1+this.name+text.textAllP2;return"sms:&body="+encodeURIComponent(e)});var source=$("#campuses-template").html(),template=Handlebars.compile(source);$("#campuses-container").append(template(templateData)),$(document).ready(function(){$("body").on("click",".campus .title",function(){var e=$(this);e.siblings(".collapse").collapse("toggle"),e.parents(".campus").toggleClass("open")}),$("#inviteModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=t.data("invite-method"),n="",i=t.data("campus-id"),o=templateData.campuses.filter(function(e){return e.id===i})[0];switch(o.tueLabel=templateData.tueLabel,o.wedLabel=templateData.wedLabel,o.thuLabel=templateData.thuLabel,a){case"email":n="Send an email invite";break;case"text":n="Send a text message invite";break;case"facebook":n="Share on Facebook"}var s=$("#"+a+"-invite-template").html(),r=Handlebars.compile(s),l=$(this);l.find(".modal-title").text(n),l.find(".modal-body").html(r(o))})});var setActiveCampus=function(e){var t=$(".campus.active");t.length&&t.removeClass("active open").find(".collapse").removeClass("in"),$(".campus[data-campus-id="+e+"]").addClass("active open").insertBefore(".campus:first").find(".collapse").addClass("in"),Cookies.set("christmas_campus",e)};determineInitialCampus(),navigator.geolocation&&$(".js-find-nearest-container").html('<button type="button" class="btn btn-default find-nearest" onClick="findNearestCampus(this)"><i class="loading-icon"></i> Find Nearest Campus</button>'),$("body").on("click",".js-track-sms",function(){var e=$(this).data("label");ga("send",{hitType:"event",eventCategory:"Christmas Invite Page",eventAction:"Text Invite",eventLabel:e})}),$("body").on("click",".js-track-email",function(){var e=$(this).data("label");ga("send",{hitType:"event",eventCategory:"Christmas Invite Page",eventAction:"Email Invite",eventLabel:e})}),$("body").on("click",".js-track-fb",function(){var e=$(this).data("label");ga("send",{hitType:"event",eventCategory:"Christmas Invite Page",eventAction:"Facebook Invite",eventLabel:e})}),TweenMax.fromTo(".a-swing",2,{rotation:-30},{rotation:30,transformOrigin:"top center",ease:Quad.easeInOut,repeat:-1,yoyo:!0}),TweenMax.fromTo(".a-hinge",2,{rotation:-30},{rotation:-20,transformOrigin:"top right",ease:Quad.easeInOut,repeat:-1,yoyo:!0,delay:1}),TweenMax.fromTo(".a-swing-delay",2,{rotation:-30},{rotation:30,transformOrigin:"top center",ease:Quad.easeInOut,delay:2,repeat:-1,yoyo:!0}),TweenMax.to(".a-spin-left",12,{rotation:-360,transformOrigin:"center center",ease:Linear.easeNone,repeat:-1}),TweenMax.to(".a-spin-right",12,{rotation:360,transformOrigin:"center center",ease:Linear.easeNone,repeat:-1}),TweenMax.fromTo(".a-pulse-1",2,{scale:.75},{scale:1.25,transformOrigin:"center center",repeat:-1,yoyo:!0}),TweenMax.fromTo(".a-pulse-2",2,{scale:.75},{scale:1.25,transformOrigin:"center center",repeat:-1,yoyo:!0,delay:1}),TweenMax.fromTo(".a-pulse-3",2,{scale:.75},{scale:1.25,transformOrigin:"center center",repeat:-1,yoyo:!0,delay:2}),TweenMax.to(".a-burst-l",3,{scale:1.3,transformOrigin:"center center",repeat:-1,ease:Quad.easeInOut,yoyo:!0});